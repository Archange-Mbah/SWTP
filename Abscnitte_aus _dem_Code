/*part 1
-die Hauptmethode zur Generierung  von Code
-Bearbeitet die Behaviors
- Behavioir besteht aus  Alternative und messages.
- wenn das objekt eine Instanz von message ist dann ruften wir  compile(message message); 
-wenn das objekt eine Instanz von  alternative ist dann ruft er compile2(alternative alternative);
*/
def String compileBehavior(behavior behavior1) {

		var String ret = "void loop () { \n";
		
		for (element element1 : behavior1.getElements()) {
			if (element1 instanceof message) ret+=compile((element1 as message)) + "";
			if(element1 instanceof alternative) ret+=compile2(element1 as alternative);
      }
      
   ret += "\n }";
	
return ret;
}


/*part 2 compile
def String compile(message element1){
		var ret="";
		if (element1 instanceof message) {
				ret += (element1 as message).getMethod().getOpeation().getName().toString + "(";
				var par = (element1 as message).getMethod().getParameter_list().size;
			
			var currentIndex = 0;

			for (parameter param : (element1 as message).getMethod().getParameter_list()) {
				if (param.getConstant() !== null) {

					if (param.getConstant().equals("0")) {
						ret += "LOW";
					} else if (param.getConstant().equals("1")) {
						ret += "HIGH";
					} else
						ret += param.getConstant();
				}
				if (param.getComponent() !== null) {
					// ret+= param.getComponent();
					for (wiring wire1 : connection_list.getWiring()) {
						   if ((wire1.getSrc_port().getName().equals("DIGITAL_OUT")) &&
							(element1 as message).getMethod().getOpeation().getName().toString.equals("digitalWrite")	&& 
							(wire1.getSrc().getName().equals(param.getComponent().getName()))) 
							{
								ret += wire1.getTar_port().getName();
							}
							else if ((wire1.getSrc_port().getName().equals("DIGITAL_OUT")) &&
							(element1 as message).getMethod().getOpeation().getName().toString.equals("tone")	&& 
							(wire1.getSrc().getName().equals(param.getComponent().getName()))) 
							{
								ret += wire1.getTar_port().getName();
							}
							
							else if (wire1.getTar_port().getName().equals("DIGITAL_OUT") &&(
								(element1 as message).getMethod().getOpeation().getName().toString.equals(
									"digitalWrite")) && (wire1.getTar().getName().equals(param.getComponent().getName()))
									) 
									{
								ret += wire1.getSrc_port().getName();
							}
							else  if( wire1.getTar_port().getName().equals("DIGITAL_OUT") &&((element1 as message).getMethod().getOpeation().getName().toString.equals(
									"tone"))
							 &&(wire1.getTar().getName().equals(param.getComponent().getName())))
									{
									ret += wire1.getSrc_port().getName();
						}
					}
				} // else if(param.get)
				else {
					ret += "";
				}
				currentIndex = currentIndex + 1;
				if (currentIndex < par) {
					ret += ",";
				}
			}
			ret += ");  \n";
		}
		
	
	return ret;
	}
